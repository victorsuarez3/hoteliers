function NavisConvertTagToPhoneNumberBasic(t){
	if (t != null) t = t.toLowerCase();
	switch (t){
		case "8008181010": return("8008181010");
		case "8008921600": return("8008921600");
		case "8014712456": return("8014712456");
		case "8332261158": return("8332261158");
		case "8337556536": return("8337556536");
		case "8442016889": return("8442016889");
		case "8442068680": return("8442068680");
		case "8442075122": return("8442075122");
		case "8442078607": return("8442078607");
		case "8442383248": return("8442383248");
		case "8442509513": return("8442509513");
		case "8442522650": return("8442522650");
		case "8442524806": return("8442524806");
		case "8442524808": return("8442524808");
		case "8442531886": return("8442531886");
		case "8442540017": return("8442540017");
		case "8442543965": return("8442543965");
		case "8442543967": return("8442543967");
		case "8442589206": return("8442589206");
		case "8442751435": return("8442751435");
		case "8442827871": return("8442827871");
		case "8442960312": return("8442960312");
		case "8443301727": return("8443301727");
		case "8443379184": return("8443379184");
		case "8443619001": return("8443619001");
		case "8443619464": return("8443619464");
		case "8443620222": return("8443620222");
		case "8443627110": return("8443627110");
		case "8443661995": return("8443661995");
		case "8443742214": return("8443742214");
		case "8443851312": return("8443851312");
		case "8443954955": return("8443954955");
		case "8443996142": return("8443996142");
		case "8444411771": return("8444411771");
		case "8444913663": return("8444913663");
		case "8444966223": return("8444966223");
		case "8445331359": return("8445331359");
		case "8445360363": return("8445360363");
		case "8445498701": return("8445498701");
		case "8445633103": return("8445633103");
		case "8445822733": return("8445822733");
		case "8445859149": return("8445859149");
		case "8445952733": return("8445952733");
		case "8446172466": return("8446172466");
		case "8446682881": return("8446682881");
		case "8446723988": return("8446723988");
		case "8446831441": return("8446831441");
		case "8447196881": return("8447196881");
		case "8447246613": return("8447246613");
		case "8448117247": return("8448117247");
		case "8448239373": return("8448239373");
		case "8448293659": return("8448293659");
		case "8448378778": return("8448378778");
		case "8448481655": return("8448481655");
		case "8448745537": return("8448745537");
		case "8448798844": return("8448798844");
		case "8449478687": return("8449478687");
		case "8449772733": return("8449772733");
		case "8449939610": return("8449939610");
		case "8449939776": return("8449939776");
		case "8552024202": return("8552024202");
		case "8552038588": return("8552038588");
		case "8552262916": return("8552262916");
		case "8552291516": return("8552291516");
		case "8552313817": return("8552313817");
		case "8552338649": return("8552338649");
		case "8552342622": return("8552342622");
		case "8552344755": return("8552344755");
		case "8552383352": return("8552383352");
		case "8552468384": return("8552468384");
		case "8552478345": return("8552478345");
		case "8552503347": return("8552503347");
		case "8552525350": return("8552525350");
		case "8552557207": return("8552557207");
		case "8552773652": return("8552773652");
		case "8552822499": return("8552822499");
		case "8552946120": return("8552946120");
		case "8552978125": return("8552978125");
		case "8552978803": return("8552978803");
		case "8553181117": return("8553181117");
		case "8553181692": return("8553181692");
		case "8553181763": return("8553181763");
		case "8553184757": return("8553184757");
		case "8553185902": return("8553185902");
		case "8553186883": return("8553186883");
		case "8553189804": return("8553189804");
		case "8553195582": return("8553195582");
		case "flash": return("8553201502");
		case "8553249850": return("8553249850");
		case "8553428739": return("8553428739");
		case "8553462138": return("8553462138");
		case "8553601470": return("8553601470");
		case "8553701617": return("8553701617");
		case "8553750624": return("8553750624");
		case "8553761632": return("8553761632");
		case "8553872454": return("8553872454");
		case "8553926713": return("8553926713");
		case "8553966195": return("8553966195");
		case "8554065467": return("8554065467");
		case "8554067103": return("8554067103");
		case "8554162033": return("8554162033");
		case "8554208041": return("8554208041");
		case "8554208052": return("8554208052");
		case "8554208168": return("8554208168");
		case "8554208342": return("8554208342");
		case "8554209033": return("8554209033");
		case "8554209991": return("8554209991");
		case "8554209995": return("8554209995");
		case "8554210431": return("8554210431");
		case "8554211400": return("8554211400");
		case "8554211551": return("8554211551");
		case "8554211554": return("8554211554");
		case "8554211559": return("8554211559");
		case "8554212105": return("8554212105");
		case "8554212109": return("8554212109");
		case "8554212259": return("8554212259");
		case "8554213050": return("8554213050");
		case "8554213283": return("8554213283");
		case "8554226654": return("8554226654");
		case "8554260189": return("8554260189");
		case "8554388703": return("8554388703");
		case "8554498440": return("8554498440");
		case "8554622758": return("8554622758");
		case "8554648034": return("8554648034");
		case "8554862146": return("8554862146");
		case "8554889392": return("8554889392");
		case "8554942990": return("8554942990");
		case "8554995954": return("8554995954");
		case "8555010029": return("8555010029");
		case "8555052867": return("8555052867");
		case "default email": return("8555107682");
		case "8555109701": return("8555109701");
		case "8555178458": return("8555178458");
		case "8555361240": return("8555361240");
		case "8555469739": return("8555469739");
		case "8555469769": return("8555469769");
		case "8555607007": return("8555607007");
		case "8555700639": return("8555700639");
		case "8555723118": return("8555723118");
		case "8555772795": return("8555772795");
		case "8555900451": return("8555900451");
		case "8555911808": return("8555911808");
		case "8555914870": return("8555914870");
		case "8556025889": return("8556025889");
		case "8556032783": return("8556032783");
		case "8556041312": return("8556041312");
		case "8556102227": return("8556102227");
		case "8556536065": return("8556536065");
		case "8556598324": return("8556598324");
		case "8556667887": return("8556667887");
		case "8556667915": return("8556667915");
		case "8556697674": return("8556697674");
		case "8556728625": return("8556728625");
		case "8556746571": return("8556746571");
		case "8556747737": return("8556747737");
		case "8556756906": return("8556756906");
		case "8556836196": return("8556836196");
		case "8556884432": return("8556884432");
		case "8556887055": return("8556887055");
		case "8556928763": return("8556928763");
		case "8557045601": return("8557045601");
		case "8557085734": return("8557085734");
		case "8557100382": return("8557100382");
		case "8557233135": return("8557233135");
		case "8557342440": return("8557342440");
		case "8557508896": return("8557508896");
		case "8557508898": return("8557508898");
		case "8557508900": return("8557508900");
		case "8557527350": return("8557527350");
		case "8557723747": return("8557723747");
		case "8557776504": return("8557776504");
		case "8557993812": return("8557993812");
		case "8558108210": return("8558108210");
		case "8558127411": return("8558127411");
		case "8558163580": return("8558163580");
		case "8558192228": return("8558192228");
		case "8558194386": return("8558194386");
		case "8558194391": return("8558194391");
		case "8558235627": return("8558235627");
		case "8558236910": return("8558236910");
		case "8558250012": return("8558250012");
		case "8558301951": return("8558301951");
		case "8558315995": return("8558315995");
		case "8558366300": return("8558366300");
		case "8558436751": return("8558436751");
		case "8558473709": return("8558473709");
		case "8558504234": return("8558504234");
		case "8558518215": return("8558518215");
		case "8558614373": return("8558614373");
		case "8558682701": return("8558682701");
		case "8558687978": return("8558687978");
		case "8558751867": return("8558751867");
		case "8558785238": return("8558785238");
		case "8558845799": return("8558845799");
		case "8558898601": return("8558898601");
		case "8558960028": return("8558960028");
		case "8558973345": return("8558973345");
		case "8559237861": return("8559237861");
		case "8559237934": return("8559237934");
		case "8559296736": return("8559296736");
		case "8559693225": return("8559693225");
		case "8559693236": return("8559693236");
		case "8559693237": return("8559693237");
		case "8559693240": return("8559693240");
		case "8559693241": return("8559693241");
		case "8559693244": return("8559693244");
		case "8559693329": return("8559693329");
		case "8559900123": return("8559900123");
		case "8662037934": return("8662037934");
		case "8662053020": return("8662053020");
		case "8662272414": return("8662272414");
		case "8662413164": return("8662413164");
		case "8662471457": return("8662471457");
		case "8662471701": return("8662471701");
		case "8662490891": return("8662490891");
		case "8662491187": return("8662491187");
		case "8662496179": return("8662496179");
		case "8662518714": return("8662518714");
		case "8662548810": return("8662548810");
		case "organic": return("8662597468");
		case "8662692077": return("8662692077");
		case "8662765817": return("8662765817");
		case "8662903368": return("8662903368");
		case "8663481872": return("8663481872");
		case "8663517444": return("8663517444");
		case "8663623727": return("8663623727");
		case "8663989327": return("8663989327");
		case "8664277595": return("8664277595");
		case "test": return("8664414923");
		case "8664525592": return("8664525592");
		case "8664539496": return("8664539496");
		case "utah flash": return("8664625861");
		case "8664682480": return("8664682480");
		case "8664715667": return("8664715667");
		case "8664966569": return("8664966569");
		case "8665223876": return("8665223876");
		case "8665508563": return("8665508563");
		case "8665518716": return("8665518716");
		case "8665825859": return("8665825859");
		case "8665835262": return("8665835262");
		case "8665875455": return("8665875455");
		case "8665905360": return("8665905360");
		case "8665933822": return("8665933822");
		case "8666411884": return("8666411884");
		case "8666545401": return("8666545401");
		case "8666545785": return("8666545785");
		case "8666545921": return("8666545921");
		case "8666619556": return("8666619556");
		case "8666722126": return("8666722126");
		case "8666744658": return("8666744658");
		case "8666780279": return("8666780279");
		case "8666897307": return("8666897307");
		case "8667228331": return("8667228331");
		case "8667344428": return("8667344428");
		case "8667349646": return("8667349646");
		case "8667645406": return("8667645406");
		case "8667844434": return("8667844434");
		case "8667850150": return("8667850150");
		case "8667922466": return("8667922466");
		case "8668027425": return("8668027425");
		case "8668048465": return("8668048465");
		case "8668491149": return("8668491149");
		case "8668491494": return("8668491494");
		case "8668912475": return("8668912475");
		case "8668960803": return("8668960803");
		case "8668966021": return("8668966021");
		case "8669038462": return("8669038462");
		case "8669069744": return("8669069744");
		case "8669313679": return("8669313679");
		case "8669345107": return("8669345107");
		case "8669660384": return("8669660384");
		case "8669737179": return("8669737179");
		case "8669761059": return("8669761059");
		case "8669769270": return("8669769270");
		case "8669885349": return("8669885349");
		case "8772134362": return("8772134362");
		case "8772171354": return("8772171354");
		case "8772368509": return("8772368509");
		case "8772460541": return("8772460541");
		case "8772617065": return("8772617065");
		case "8772737199": return("8772737199");
		case "8772753110": return("8772753110");
		case "8772916552": return("8772916552");
		case "8772917623": return("8772917623");
		case "8773006223": return("8773006223");
		case "8773259982": return("8773259982");
		case "8773269681": return("8773269681");
		case "webcontact": return("8773460743");
		case "8773465764": return("8773465764");
		case "8773468956": return("8773468956");
		case "8773602374": return("8773602374");
		case "8773986837": return("8773986837");
		case "8774229458": return("8774229458");
		case "8774233251": return("8774233251");
		case "8774359290": return("8774359290");
		case "8774592551": return("8774592551");
		case "8774962076": return("8774962076");
		case "8774965924": return("8774965924");
		case "8774968841": return("8774968841");
		case "8774972898": return("8774972898");
		case "8775331929": return("8775331929");
		case "8775379382": return("8775379382");
		case "8775416756": return("8775416756");
		case "8775471551": return("8775471551");
		case "8775672196": return("8775672196");
		case "8775840388": return("8775840388");
		case "8775863130": return("8775863130");
		case "8775943095": return("8775943095");
		case "8776240051": return("8776240051");
		case "8776240052": return("8776240052");
		case "8776240682": return("8776240682");
		case "8776242797": return("8776242797");
		case "8776248721": return("8776248721");
		case "8776249882": return("8776249882");
		case "8776400215": return("8776400215");
		case "8776486403": return("8776486403");
		case "8776843006": return("8776843006");
		case "8776849996": return("8776849996");
		case "8776865260": return("8776865260");
		case "8776867941": return("8776867941");
		case "8776867942": return("8776867942");
		case "8776878167": return("8776878167");
		case "8777003617": return("8777003617");
		case "8777132034": return("8777132034");
		case "8777134723": return("8777134723");
		case "8777136843": return("8777136843");
		case "8777136845": return("8777136845");
		case "8777240116": return("8777240116");
		case "8777416602": return("8777416602");
		case "8777423265": return("8777423265");
		case "8777515484": return("8777515484");
		case "8777714233": return("8777714233");
		case "8777753013": return("8777753013");
		case "8777833309": return("8777833309");
		case "8778039185": return("8778039185");
		case "8778306635": return("8778306635");
		case "8778312532": return("8778312532");
		case "8778496721": return("8778496721");
		case "8778508132": return("8778508132");
		case "8778533051": return("8778533051");
		case "8778639316": return("8778639316");
		case "8778821847": return("8778821847");
		case "8778821874": return("8778821874");
		case "8778916523": return("8778916523");
		case "8779012904": return("8779012904");
		case "8779166641": return("8779166641");
		case "8779347868": return("8779347868");
		case "8779356099": return("8779356099");
		case "8779356645": return("8779356645");
		case "8882112023": return("8882112023");
		case "8882208014": return("8882208014");
		case "8882655623": return("8882655623");
		case "8882752850": return("8882752850");
		case "8883163359": return("8883163359");
		case "8883281392": return("8883281392");
		case "8883281502": return("8883281502");
		case "8883290143": return("8883290143");
		case "8883439918": return("8883439918");
		case "8883521664": return("8883521664");
		case "8883647190": return("8883647190");
		case "8883742955": return("8883742955");
		case "8883858347": return("8883858347");
		case "ppc": return("8883944165");
		case "8883944169": return("8883944169");
		case "8883946629": return("8883946629");
		case "8884023861": return("8884023861");
		case "8884064045": return("8884064045");
		case "8884067161": return("8884067161");
		case "udot": return("8884115640");
		case "8884160435": return("8884160435");
		case "8884855193": return("8884855193");
		case "8884941146": return("8884941146");
		case "8884968214": return("8884968214");
		case "8885527614": return("8885527614");
		case "8885656540": return("8885656540");
		case "8886153390": return("8886153390");
		case "8886290261": return("8886290261");
		case "8886441311": return("8886441311");
		case "8886727521": return("8886727521");
		case "8886893436": return("8886893436");
		case "8887144650": return("8887144650");
		case "8887145389": return("8887145389");
		case "8887275745": return("8887275745");
		case "8887392553": return("8887392553");
		case "8887393032": return("8887393032");
		case "8887410538": return("8887410538");
		case "8887452763": return("8887452763");
		case "memorial": return("8887475774");
		case "8887911783": return("8887911783");
		case "8887926013": return("8887926013");
		case "8888164627": return("8888164627");
		case "8888170770": return("8888170770");
		case "8888337812": return("8888337812");
		case "8888530942": return("8888530942");
		case "8888591581": return("8888591581");
		case "8888615120": return("8888615120");
		case "8889651209": return("8889651209");
		case "8889655329": return("8889655329");
		case "8889655839": return("8889655839");
		case "8889655891": return("8889655891");
		case "8889657046": return("8889657046");
		case "8889740767": return("8889740767");
		case "8889741126": return("8889741126");
		case "8889742964": return("8889742964");
		case "8889743145": return("8889743145");
		case "8889744079": return("8889744079");
		case "8889745516": return("8889745516");
		case "8889747634": return("8889747634");
		case "8889748501": return("8889748501");
		case "8889749187": return("8889749187");
		case "8889760691": return("8889760691");
		case "8889760852": return("8889760852");
		case "8889764799": return("8889764799");
		case "8889764892": return("8889764892");
		case "8889765317": return("8889765317");
	}
	return("8662597468");
}


function ValidateNavisKeyword(t){
	return t;
}


function CreateNavisTagCookie(t) {
	CreateNavisTagCookie3(t, "", 90);
}

function CreateNavisTagCookie2(t, dom) {
	CreateNavisTagCookie3(t, dom, 90);
}

var NavisCookieKeywordValue = null;
function CreateNavisTagCookie3(t, dom, days) {
	var date = new Date();
	date.setTime(date.getTime()+(days*24*60*60*1000));
	var expires = "; expires="+date.toGMTString();
	var domstr = (dom=="")? "" : "; domain=" + dom;
	document.cookie = "14378NavisNCKeyword="+t+expires+domstr+"; path=/";
	document.cookie = "NavisNCKeyword="+expires+domstr+"; path=/";
	NavisCookieKeywordValue = t;
}


function ReadNavisTagCookie1(n) {
    //actually used to read both tag cookies and contactId cookies
	var nameEQ = n + "=";
	var ca = document.cookie.split(';');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		while (c.charAt(0)==' ') c = c.substring(1,c.length);
		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
	}
	return null;
}



function ReadNavisTagCookie() {
	var c0 = NavisCookieKeywordValue;
	if (c0 != null) return ValidateNavisKeyword(c0);
	var c1 = ReadNavisTagCookie1("14378NavisNCKeyword");
	if (c1 != null) return ValidateNavisKeyword(c1);
	var c2 = ReadNavisTagCookie1("NavisNCKeyword");
	return ValidateNavisKeyword(c2);
}


function GetNavisQueryString(name){
	var nameEQ = name + "=";
	nameEQ = nameEQ.toLowerCase();
	//alert(window.location.search.substring(1, window.location.search.length));
	var ca = window.location.search.substring(1, window.location.search.length).split('&');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		c = c.toLowerCase();
		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
	}
	return null;
}

function GetNavisTagQueryString(){
    return GetNavisQueryString("NCK");
}


function NavisGetDomain(url){
	var rs = url.split('/');
	var rd = rs.length > 2 ? rs[2].toLowerCase() : null;
	return rd;
}
	

function GetNavisTagReferrer(){
	return GetNavisTagReferrer2("");
}
function GetNavisTagReferrer2(dom){
	var rd = NavisGetDomain(document.referrer);
	if (rd == null) return null;
	var ld = NavisGetDomain(document.location.href);
	if (rd == ld) return null;
	if (dom != "" && dom != null){
		if (dom.substring(0, 1) == ".") dom = dom.substring(1,dom.length);
		if (rd == dom) return null;
		dom = "." + dom;
		if (rd.length > dom.length && rd.substring(rd.length-dom.length, dom.length) == dom) return null;
	}
	return rd;
}

function GetNavisTagHash(){
	var nameEQ = "NCK=";
	nameEQ = nameEQ.toLowerCase();
	var h = document.location.hash;
	h = h.toLowerCase();
	return (h.substring(1, nameEQ.length + 1) == nameEQ) ? h.substring(nameEQ.length + 1, h.length) : null; 
}

	

function ProcessNavisNCKeyword(){
	ProcessNavisNCKeyword5("", true, false, false, 90);
}

function ProcessNavisNCKeyword2(dom){
	ProcessNavisNCKeyword5(dom, true, false, false, 90);
}

function ProcessNavisNCKeyword3(dom, referrer){
	ProcessNavisNCKeyword5(dom, true, false, referrer, 90);
}

function ProcessNavisNCKeyword4(dom, querystring, hash, referrer){
	ProcessNavisNCKeyword5(dom, querystring, hash, referrer, 90)
}

//dom: domain for the cookie, useful for cookies that persist on multiple subdomains
//querystring:  Should I look in the querystring for the token?
//hash:  Should I look in the hash (the part of the URL after #) for the token?
//referrer:  Should I use the domain of the referrer as the token?
//days: how many days the cookie should persist for
function ProcessNavisNCKeyword5(dom, querystring, hash, referrer, days){
	var t = null;
	if (t == null && querystring){
		t = GetNavisTagQueryString();
	}
	if (t == null && hash){
		t = GetNavisTagHash();
	}
	if (t == null && referrer){
		t = GetNavisTagReferrer2(dom);
	}
	
	if (t != null){
		CreateNavisTagCookie3(t, dom, days);
	}

    ProcessNavisContactId(dom)
}



function FormatPhone(ph, fmt){
	var fs = fmt.split("#");
	var s = "";
	for (var i = 0; i < 10; i++){
		s += fs[i] + ph.substr(i, 1);
	}
	s += fs[10];
	return s;
}

function ShowNavisNCPhoneNumber(){
	ShowNavisNCPhoneNumberFormat("(###) ###-####");
}

function ShowNavisNCPhoneNumberFormat(fmt){
	var ph = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
	document.write(FormatPhone(ph, fmt));
}


function SetElementToNavisNCPhoneNumber(id){
	SetElementToNavisNCPhoneNumberFormat(id, "(###) ###-####");
}

function SetElementToNavisNCPhoneNumberFormat(id, fmt){
	var el = document.getElementById(id);
	if (el == null){
		return
	} 
	var ph = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
    ph = FormatPhone(ph, fmt);
    el.innerHTML = ph;
}

function NavisConvertTagToPhoneNumber(t){
	return FormatPhone(NavisConvertTagToPhoneNumberBasic(t), "(###) ###-####");
}

function NavisSetHiddenKeywordField(id){
	NavisSetHiddenKeywordFieldD(id, null);
}
function NavisSetHiddenKeywordFieldD(id, deflt){
	var fld = document.getElementById(id);
	if (fld != null){
		var kwd = ReadNavisTagCookie();
		if (kwd == null && deflt != null) kwd = deflt;
		fld.value = kwd;
	}
}
function NavisSetHiddenPhoneNumberField(id){
	var fld = document.getElementById(id);
	if (fld != null){
		fld.value = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
	}
}



function SetNavisP2TalkLink(linkId){
	SetNavisLink(linkId, "P2Talk", "");
}
function SetNavisP2TalkCustomLink(linkId){
	SetNavisLink(linkId, "P2TCust", "");
}
function SetNavisP2ChatLink(linkId){
	SetNavisLink(linkId, "P2ChatIni", "");
}
function SetNavisP2ChatCustomLink(linkId){
	SetNavisLink(linkId, "P2ChatIni", "&cust=1");
}
function SetNavisLink(linkId, page, extra){
	var lnk = document.getElementById(linkId);
	if (lnk != null && (lnk.tagName.toLowerCase() == "a" || lnk.tagName.toLowerCase() == "area")){
		var ph = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
		var acct = "14378";

		lnk.href = "https://www.thenavisway.com/p2talk/" + page + ".aspx?account=" + acct + "&dnis=" + ph + "&contactid=" + ReadNavisContactIdCookie() + extra;
	}
}


function AppendNavisKeywordToURL(url){
	var kwd = ReadNavisTagCookie();
	url = AppendNavisItemToURL(url, "NCK", kwd);
	var c = ReadNavisContactIdCookie();
	url = AppendNavisItemToURL(url, "ContactId", c);
    return url;
}

function AppendNavisKeywordToLink(linkId){
	var kwd = ReadNavisTagCookie();
	AppendNavisItemToLink(linkId, "NCK", kwd);
	var c = ReadNavisContactIdCookie();
	AppendNavisItemToLink(linkId, "ContactId", c);
}

function AppendNavisPhoneNumberToLink(linkId, param){
	var tfn = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
	AppendNavisItemToLink(linkId, param, tfn);
}

function SetTelLinkToNavisPhoneNumber(linkId){
    SetLinkToNavisPhoneNumber(linkId, "tel:+1");
}

function SetLinkToNavisPhoneNumber(linkId, prefix){
	var tfn = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
	var lnk = document.getElementById(linkId);
	if (lnk == null){
		return
	} 
	var tag = lnk.tagName.toLowerCase();
	if (tag == "a" || tag == "area"){
		lnk.href = prefix + tfn;
	}
}


function AppendNavisItemToURL(url, param, val){
	if (val != null){
		var hl = url.indexOf("#");
		var ha = ""
		if (hl != -1){
			ha = url.substr(hl);
			url = url.substr(0, hl);
		}
		return url + (url.indexOf("?") == -1 ? "?" : "&") + param + "=" + val + ha;
	}
	return url;
}

function AppendNavisItemToLink(linkId, param, val){
	var lnk = document.getElementById(linkId);
	if (lnk == null){
		return
	} 
	var tag = lnk.tagName.toLowerCase();
	if (tag == "a" || tag == "area"){
		lnk.href = AppendNavisItemToURL(lnk.href, param, val);
	} else if (tag == "iframe"){
		lnk.src = AppendNavisItemToURL(lnk.src, param, val);
	} else if (tag == "form"){
		lnk.action = AppendNavisItemToURL(lnk.action, param, val);
	}
}



function SendNavisConfirmationNumberField(resnum, fld){
	var ph = NavisConvertTagToPhoneNumberBasic(ReadNavisTagCookie());
	var navisPixel =new Image();
	var acct = "14378";
	var jspass = "SHHDYII6L0C4TAE7HPZY";
	navisPixel.src="https://www.thenavisway.com/Narrowcast/Interface/OnlineBookingPixel.aspx?acct=" + acct + "&jspass=" + jspass + "&" + fld + "=" + resnum + "&tfn=" + ph + "&n=" + GetNavisUniqueTimeValue();
}


function SendNavisConfirmationNumber(resnum){
	SendNavisConfirmationNumberField(resnum, "resnum");
}

function SendNavisAltConfirmationNumber(altresnum){
	SendNavisConfirmationNumberField(altresnum, "altresnum");
}





//ContactId Specific

var NavisCookieContactIdValue = null;
function CreateNavisContactIdCookie(contactid, dom) {
    var regex = /^[0-9]{4,19}$/i;
    if (contactid == null){
        return;
    } else if (contactid == ""){
        return;
    } else if (contactid == "clear"){
        contactid = "";
    } else if (!regex.test(contactid)) {
        return;
    }
	var date = new Date();
	date.setTime(date.getTime()+(10*365*24*60*60*1000));
	var expires = "; expires="+date.toGMTString();
	var domstr = (dom=="")? "" : "; domain=" + dom;
	document.cookie = "14378NavisContactId="+contactid+expires+domstr+"; path=/";
	NavisCookieContactIdValue = contactid;
}

function ReadNavisContactIdCookie() {
	var c0 = NavisCookieContactIdValue;
	if (c0 != null) return c0;
	var c1 = ReadNavisTagCookie1("14378NavisContactId");
	return c1;
}

function GetNavisContactIdQueryString(){
    return GetNavisQueryString("ContactId");
}

function ProcessNavisContactId(dom){
	var c = GetNavisContactIdQueryString();
	if (c != null){
		CreateNavisContactIdCookie(c, dom);
	}
}


function SendNavisContactIdAttribute(attributename, attributevalue){
    SendNavisContactIdAttributeData("&AttributeName=" + encodeURIComponent(attributename) + "&AttributeValue=" + encodeURIComponent(attributevalue));
}

function SendNavisContactIdAttributeIncrement(attributename, incrementby){
    SendNavisContactIdAttributeIncrement2(attributename, incrementby, incrementby);
}

function SendNavisContactIdAttributeIncrement2(attributename, incrementby, initialvalue){
    SendNavisContactIdAttributeData("&AttributeName=" + encodeURIComponent(attributename) + "&InitialValue=" + encodeURIComponent(initialvalue) + "&IncrementBy=" + encodeURIComponent(incrementby));
}

function SendNavisContactIdAttributeData(params){
	var c = ReadNavisContactIdCookie();
    if (c == null || c == ""){
        return;
    }
	var navisPixel =new Image();
	var acct = "14378";
	var jspass = "SHHDYII6L0C4TAE7HPZY";
	navisPixel.src="https://www.thenavisway.com/CRM/Interface/ContactPixel.aspx?acct=" + acct + "&jspass=" + jspass + "&ContactID=" + c + params + "&n=" + GetNavisUniqueTimeValue();
}

function GetNavisUniqueTimeValue(){
    var d = new Date();
    var n = d.getTime();
    var ns = n + "";
    return ns;
}    